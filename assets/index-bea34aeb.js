import{a as e,c as a,k as l,d as t,r as o,J as i,o as s,a3 as r,w as d,f as n,aU as u,a2 as m,O as p,l as c,aR as f,ad as g,t as h,a6 as v,ae as _,c$ as b,aV as y,aW as j}from"./index-6faa080d.js";import{v as k}from"./el-loading-8f6af84a.js";import{E as V}from"./el-scrollbar-23b8bf90.js";import{E as w}from"./el-tree-1d5c4005.js";import"./el-checkbox-609c22c0.js";import{E as x}from"./el-dialog-3f95f01f.js";import{E as C}from"./el-input-number-c1c432f9.js";import{b as U,a as E}from"./el-radio-group-f1301294.js";import{_ as S,a as z,b as R}from"./refresh-a26101e9.js";/* empty css               */import{E as q,a as F}from"./el-select-1dcebd9c.js";import"./el-popper-e2dab256.js";import{E as N}from"./el-card-64202a98.js";import{_ as T}from"./index-1b3ce5e9.js";import{E as A,a as B}from"./el-table-column-fe2badb5.js";import"./el-tooltip-4ed993c7.js";import{_ as O}from"./plus-498b65ec.js";import{E as I,a as K}from"./el-form-item-4a62155a.js";import{_ as L}from"./search-81f6e38b.js";import{g as P,a as W,u as H,b as J,d as M,c as Q,e as X}from"./index-6d734836.js";import{E as Y}from"./index-b448741e.js";import"./index-4d151efb.js";import"./isEqual-8f65086e.js";import"./_Uint8Array-f250736d.js";import"./hasIn-4b21a690.js";import"./refs-478724bb.js";import"./isUndefined-d281c39a.js";import"./strings-161f22ae.js";import"./debounce-43ed913c.js";import"./index-0ffc233c.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./_initCloneObject-5f559ccd.js";import"./castArray-62781553.js";const $={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},D=[l("path",{fill:"currentColor",d:"m249.6 417.088l319.744 43.072l39.168 310.272L845.12 178.88zm-129.024 47.168a32 32 0 0 1-7.68-61.44l777.792-311.04a32 32 0 0 1 41.6 41.6l-310.336 775.68a32 32 0 0 1-61.44-7.808L512 516.992z"},null,-1)];const G={name:"ep-position",render:function(l,t){return e(),a("svg",$,[...D])}},Z={class:"app-container"},ee={class:"search-container"},ae={class:"dialog-footer"},le={class:"dialog-footer"},te=t({name:"Role",inheritAttrs:!1,__name:"index",setup(t){const $=o(I),D=o(I),te=o(w),oe=o(!1),ie=o([]),se=o(0),re=i({pageNum:1,pageSize:10}),de=o(),ne=i({title:"",visible:!1}),ue=i({sort:1,status:1,code:"",name:""}),me=i({name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],code:[{required:!0,message:"请输入角色编码",trigger:"blur"}],dataScope:[{required:!0,message:"请选择数据权限",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}]}),pe=o(!1),ce=o([]);let fe=i({});function ge(){oe.value=!0,P(re).then((({data:e})=>{de.value=e.list,se.value=e.total})).finally((()=>{oe.value=!1}))}function he(){$.value.resetFields(),re.pageNum=1,ge()}function ve(e){ie.value=e.map((e=>e.id))}function _e(e){ne.visible=!0,e?(ne.title="修改角色",W(e).then((({data:e})=>{Object.assign(ue,e)}))):ne.title="新增角色"}function be(){D.value.validate((e=>{if(e){oe.value=!0;const e=ue.id;e?H(e,ue).then((()=>{v.success("修改成功"),ye(),he()})).finally((()=>oe.value=!1)):J(ue).then((()=>{v.success("新增成功"),ye(),he()})).finally((()=>oe.value=!1))}}))}function ye(){ne.visible=!1,D.value.resetFields(),D.value.clearValidate(),ue.id=void 0,ue.sort=1,ue.status=1}function je(e){const a=[e||ie.value].join(",");a?_.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{oe.value=!0,M(a).then((()=>{v.success("删除成功"),he()})).finally((()=>oe.value=!1))})):v.warning("请勾选删除项")}function ke(){const e=fe.id;if(e){const a=te.value.getCheckedNodes(!1,!0).map((e=>e.value));oe.value=!0,X(e,a).then((()=>{v.success("分配权限成功"),pe.value=!1,he()})).finally((()=>{oe.value=!1}))}}return s((()=>{ge()})),(t,o)=>{const i=y,s=K,v=L,_=j,P=S,W=I,H=O,J=z,M=A,X=Y,Ve=G,we=R,xe=B,Ce=T,Ue=N,Ee=q,Se=F,ze=U,Re=E,qe=C,Fe=x,Ne=w,Te=V,Ae=k;return e(),a("div",Z,[l("div",ee,[r(W,{ref_key:"queryFormRef",ref:$,model:n(re),inline:!0},{default:d((()=>[r(s,{prop:"keywords",label:"关键字"},{default:d((()=>[r(i,{modelValue:n(re).keywords,"onUpdate:modelValue":o[0]||(o[0]=e=>n(re).keywords=e),placeholder:"角色名称",clearable:"",onKeyup:u(ge,["enter"])},null,8,["modelValue"])])),_:1}),r(s,null,{default:d((()=>[r(_,{type:"primary",onClick:ge},{default:d((()=>[r(v),m("搜索")])),_:1}),r(_,{onClick:he},{default:d((()=>[r(P),m("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),r(Ue,{shadow:"never",class:"table-container"},{header:d((()=>[r(_,{type:"success",onClick:o[1]||(o[1]=e=>_e())},{default:d((()=>[r(H),m("新增")])),_:1}),r(_,{type:"danger",disabled:0===n(ie).length,onClick:o[2]||(o[2]=e=>je())},{default:d((()=>[r(J),m("删除")])),_:1},8,["disabled"])])),default:d((()=>[p((e(),c(xe,{ref:"dataTableRef",data:n(de),"highlight-current-row":"",border:"",onSelectionChange:ve},{default:d((()=>[r(M,{type:"selection",width:"55",align:"center"}),r(M,{label:"角色名称",prop:"name","min-width":"100"}),r(M,{label:"角色编码",prop:"code",width:"150"}),r(M,{label:"状态",align:"center",width:"100"},{default:d((a=>[1===a.row.status?(e(),c(X,{key:0,type:"success"},{default:d((()=>[m("正常")])),_:1})):(e(),c(X,{key:1,type:"info"},{default:d((()=>[m("禁用")])),_:1}))])),_:1}),r(M,{label:"排序",align:"center",width:"80",prop:"sort"}),r(M,{fixed:"right",label:"操作",width:"220"},{default:d((e=>[r(_,{type:"primary",size:"small",link:"",onClick:a=>function(e){const a=e.id;a&&(fe={id:a,name:e.name},pe.value=!0,oe.value=!0,b().then((e=>{ce.value=e.data,Q(a).then((({data:e})=>{e.forEach((e=>te.value.setChecked(e,!0,!1)))})).finally((()=>{oe.value=!1}))})))}(e.row)},{default:d((()=>[r(Ve),m("分配权限 ")])),_:2},1032,["onClick"]),r(_,{type:"primary",size:"small",link:"",onClick:a=>_e(e.row.id)},{default:d((()=>[r(we),m("编辑 ")])),_:2},1032,["onClick"]),r(_,{type:"primary",size:"small",link:"",onClick:a=>je(e.row.id)},{default:d((()=>[r(J),m("删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[Ae,n(oe)]]),n(se)>0?(e(),c(Ce,{key:0,total:n(se),"onUpdate:total":o[3]||(o[3]=e=>f(se)?se.value=e:null),page:n(re).pageNum,"onUpdate:page":o[4]||(o[4]=e=>n(re).pageNum=e),limit:n(re).pageSize,"onUpdate:limit":o[5]||(o[5]=e=>n(re).pageSize=e),onPagination:ge},null,8,["total","page","limit"])):g("",!0)])),_:1}),r(Fe,{modelValue:n(ne).visible,"onUpdate:modelValue":o[11]||(o[11]=e=>n(ne).visible=e),title:n(ne).title,width:"500px",onClose:ye},{footer:d((()=>[l("div",ae,[r(_,{type:"primary",onClick:be},{default:d((()=>[m("确 定")])),_:1}),r(_,{onClick:ye},{default:d((()=>[m("取 消")])),_:1})])])),default:d((()=>[r(W,{ref_key:"roleFormRef",ref:D,model:n(ue),rules:n(me),"label-width":"100px"},{default:d((()=>[r(s,{label:"角色名称",prop:"name"},{default:d((()=>[r(i,{modelValue:n(ue).name,"onUpdate:modelValue":o[6]||(o[6]=e=>n(ue).name=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),r(s,{label:"角色编码",prop:"code"},{default:d((()=>[r(i,{modelValue:n(ue).code,"onUpdate:modelValue":o[7]||(o[7]=e=>n(ue).code=e),placeholder:"请输入角色编码"},null,8,["modelValue"])])),_:1}),r(s,{label:"数据权限",prop:"dataScope"},{default:d((()=>[r(Se,{modelValue:n(ue).dataScope,"onUpdate:modelValue":o[8]||(o[8]=e=>n(ue).dataScope=e)},{default:d((()=>[(e(),c(Ee,{key:0,label:"全部数据",value:0})),(e(),c(Ee,{key:1,label:"部门及子部门数据",value:1})),(e(),c(Ee,{key:2,label:"本部门数据",value:2})),(e(),c(Ee,{key:3,label:"本人数据",value:3}))])),_:1},8,["modelValue"])])),_:1}),r(s,{label:"状态",prop:"status"},{default:d((()=>[r(Re,{modelValue:n(ue).status,"onUpdate:modelValue":o[9]||(o[9]=e=>n(ue).status=e)},{default:d((()=>[r(ze,{label:1},{default:d((()=>[m("正常")])),_:1}),r(ze,{label:0},{default:d((()=>[m("停用")])),_:1})])),_:1},8,["modelValue"])])),_:1}),r(s,{label:"排序",prop:"sort"},{default:d((()=>[r(qe,{modelValue:n(ue).sort,"onUpdate:modelValue":o[10]||(o[10]=e=>n(ue).sort=e),"controls-position":"right",min:0,style:{width:"100px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),r(Fe,{modelValue:n(pe),"onUpdate:modelValue":o[13]||(o[13]=e=>f(pe)?pe.value=e:null),title:"【"+n(fe).name+"】权限分配",width:"800px"},{footer:d((()=>[l("div",le,[r(_,{type:"primary",onClick:ke},{default:d((()=>[m("确 定")])),_:1}),r(_,{onClick:o[12]||(o[12]=e=>pe.value=!1)},{default:d((()=>[m("取 消")])),_:1})])])),default:d((()=>[p((e(),c(Te,{"max-height":"600px"},{default:d((()=>[r(Ne,{ref_key:"menuRef",ref:te,"node-key":"value","show-checkbox":"",data:n(ce),"default-expand-all":!0},{default:d((({data:e})=>[m(h(e.label),1)])),_:1},8,["data"])])),_:1})),[[Ae,n(oe)]])])),_:1},8,["modelValue","title"])])}}});export{te as default};
