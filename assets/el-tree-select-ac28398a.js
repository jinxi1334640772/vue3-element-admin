import{a as e,E as t,s as l}from"./el-select-6bb5924c.js";import{_ as a}from"./el-tree-95ac2bb7.js";import{u as s,bc as o,aY as r,C as n,$ as d,d as c,h as u,K as i,b9 as p,j as h,r as f,J as v,o as k,M as C,_ as y}from"./index-825cdc33.js";import{p as m}from"./el-checkbox-942d8636.js";import{i as b}from"./isEqual-a6bf303f.js";const g=c({extends:t,setup(e,l){const a=t.setup(e,l);delete a.selectOptionClick;const s=u().proxy;return d((()=>{a.select.cachedOptions.get(s.value)||a.select.onOptionCreate(s)})),a},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function K(e){return e||0===e}function N(e){return Array.isArray(e)&&e.length}function x(e){return Array.isArray(e)?e:K(e)?[e]:[]}function O(e,t,l,a,s){for(let o=0;o<e.length;o++){const r=e[o];if(t(r,o,e,s))return a?a(r,o,e,s):r;{const e=l(r);if(N(e)){const s=O(e,t,l,a,r);if(s)return s}}}}function E(e,t,l,a){for(let s=0;s<e.length;s++){const o=e[s];t(o,s,e,a);const r=l(o);N(r)&&E(r,t,l,o)}}const V=(e,{attrs:t,slots:l,emit:s},{select:c,tree:u,key:h})=>{i((()=>e.modelValue),(()=>{e.showCheckbox&&d((()=>{const t=u.value;t&&!b(t.getCheckedKeys(),x(e.modelValue))&&t.setCheckedKeys(x(e.modelValue))}))}),{immediate:!0,deep:!0});const f=n((()=>({value:h.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props}))),v=(e,t)=>{var l;const a=f.value[e];return p(a)?a(t,null==(l=u.value)?void 0:l.getNode(v("value",t))):t[a]},k=x(e.modelValue).map((t=>O(e.data||[],(e=>v("value",e)===t),(e=>v("children",e)),((e,t,l,a)=>a&&v("value",a))))).filter((e=>K(e))),C=n((()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return E(e.data.concat(e.cacheData),(e=>{const l=v("value",e);t.push({value:l,currentLabel:v("label",e),isDisabled:v("disabled",e)})}),(e=>v("children",e))),t})),y=n((()=>C.value.reduce(((e,t)=>({...e,[t.value]:t})),{})));return{...m(o(e),Object.keys(a.props)),...t,nodeKey:h,expandOnClickNode:n((()=>!e.checkStrictly&&e.expandOnClickNode)),defaultExpandedKeys:n((()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(k):k)),renderContent:(t,{node:a,data:s,store:o})=>t(g,{value:v("value",s),label:v("label",s),disabled:v("disabled",s)},e.renderContent?()=>e.renderContent(t,{node:a,data:s,store:o}):l.default?()=>l.default({node:a,data:s,store:o}):void 0),filterNodeMethod:(t,l,a)=>{var s;return e.filterNodeMethod?e.filterNodeMethod(t,l,a):!t||(null==(s=v("label",l))?void 0:s.includes(t))},onNodeClick:(l,a,s)=>{var o,r,n;if(null==(o=t.onNodeClick)||o.call(t,l,a,s),!e.showCheckbox||!e.checkOnClickNode)if(e.showCheckbox||!e.checkStrictly&&!a.isLeaf)e.expandOnClickNode&&s.proxy.handleExpandIconClick();else if(!v("disabled",l)){const e=null==(r=c.value)?void 0:r.options.get(v("value",l));null==(n=c.value)||n.handleOptionSelect(e)}},onCheck:(l,a)=>{if(!e.showCheckbox)return;const o=v("value",l),n=a.checkedKeys,c=e.multiple?x(e.modelValue).filter((e=>e in y.value&&!u.value.getNode(e)&&!n.includes(e))):[],i=n.concat(c);if(e.checkStrictly)s(r,e.multiple?i:i.includes(o)?o:void 0);else if(e.multiple)s(r,u.value.getCheckedKeys(!0));else{const t=O([l],(e=>!N(v("children",e))&&!v("disabled",e)),(e=>v("children",e))),a=t?v("value",t):void 0,o=K(e.modelValue)&&!!O([l],(t=>v("value",t)===e.modelValue),(e=>v("children",e)));s(r,a===e.modelValue||o?void 0:a)}d((()=>{var a;const s=x(e.modelValue);u.value.setCheckedKeys(s),null==(a=t.onCheck)||a.call(t,l,{checkedKeys:u.value.getCheckedKeys(),checkedNodes:u.value.getCheckedNodes(),halfCheckedKeys:u.value.getHalfCheckedKeys(),halfCheckedNodes:u.value.getHalfCheckedNodes()})}))},cacheOptions:C}};var A=c({props:{data:{type:Array,default:()=>[]}},setup(e){const t=h(l);return i((()=>e.data),(()=>{var l;e.data.forEach((e=>{t.cachedOptions.has(e.value)||t.cachedOptions.set(e.value,e)}));const a=(null==(l=t.selectWrapper)?void 0:l.querySelectorAll("input"))||[];Array.from(a).includes(document.activeElement)||t.setSelected()}),{flush:"post",immediate:!0}),()=>{}}});var j=y(c({name:"ElTreeSelect",inheritAttrs:!1,props:{...e.props,...a.props,cacheData:{type:Array,default:()=>[]}},setup(t,l){const{slots:c,expose:u}=l,i=f(),p=f(),h=n((()=>t.nodeKey||t.valueKey||"value")),y=((t,{attrs:l,emit:a},{tree:c,key:u})=>{const i=s("tree-select"),p={...m(o(t),Object.keys(e.props)),...l,"onUpdate:modelValue":e=>a(r,e),valueKey:u,popperClass:n((()=>{const e=[i.e("popper")];return t.popperClass&&e.push(t.popperClass),e.join(" ")})),filterMethod:(e="")=>{t.filterMethod&&t.filterMethod(e),d((()=>{var t;null==(t=c.value)||t.filter(e)}))},onVisibleChange:e=>{var a;null==(a=l.onVisibleChange)||a.call(l,e),t.filterable&&e&&p.filterMethod()}};return p})(t,l,{select:i,tree:p,key:h}),{cacheOptions:b,...g}=V(t,l,{select:i,tree:p,key:h}),K=v({});return u(K),k((()=>{Object.assign(K,{...m(p.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...m(i.value,["focus","blur"])})})),()=>C(e,v({...y,ref:e=>i.value=e}),{...c,default:()=>[C(A,{data:b.value}),C(a,v({...g,ref:e=>p.value=e}))]})}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);j.install=e=>{e.component(j.name,j)};const M=j;export{M as E};
