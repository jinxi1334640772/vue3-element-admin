import{d as e,r as a,J as l,o as t,cq as s,a as o,c as r,k as i,a3 as d,w as n,f as u,aU as p,a2 as m,O as c,l as f,ai as h,a6 as b,ae as y,aV as _,aW as j}from"./index-3270e9ea.js";import{v}from"./el-loading-96e4f195.js";import{E as g}from"./el-dialog-6f1e32d0.js";import{b as k,a as V}from"./el-radio-group-59fd418d.js";import{_ as w,a as C,b as x}from"./refresh-d5b3bd6a.js";import{E as U}from"./el-input-number-863723de.js";/* empty css               */import{E as I,a as E}from"./el-select-14e3cb48.js";import"./el-scrollbar-3c1d104f.js";import"./el-popper-76c95072.js";import"./el-tree-8344f913.js";import"./el-checkbox-d67c0723.js";import{E as q}from"./el-tree-select-f317f115.js";import{E as F}from"./el-card-d8916e7b.js";import{E as z,a as A}from"./el-table-column-c022a680.js";import"./el-tooltip-4ed993c7.js";import{_ as O}from"./plus-b07173f9.js";import{E as R,a as T}from"./el-form-item-17eaa57d.js";import{_ as B}from"./search-bb94095e.js";import{l as K,g as P,u as S,a as W,d as D,b as H}from"./index-9251c3ce.js";import{E as J}from"./index-9fdab745.js";import"./refs-ad8e2c8d.js";import"./isUndefined-d281c39a.js";import"./strings-56ed60aa.js";import"./isEqual-3384582a.js";import"./_Uint8Array-ab6d1ad7.js";import"./debounce-fe2c8074.js";import"./index-748104dc.js";import"./hasIn-12c4b375.js";import"./index-3cdba6dd.js";import"./_initCloneObject-4d18710e.js";import"./castArray-2e06144a.js";const M={class:"app-container"},Q={class:"search-container"},X={class:"dialog-footer"},Y=e({name:"Dept",inheritAttrs:!1,__name:"index",setup(e){const Y=a(R),G=a(R),L=a(!1),N=a([]),Z=l({title:"",visible:!1}),$=l({}),ee=a(),ae=a(),le=l({status:1,parentId:0,sort:1}),te=l({parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function se(){L.value=!0,K($).then((({data:e})=>{ee.value=e,L.value=!1}))}function oe(){Y.value.resetFields(),se()}function re(e){N.value=e.map((e=>e.id))}async function ie(e,a){await async function(){H().then((e=>{ae.value=[{value:0,label:"顶级部门",children:e.data}]}))}(),Z.visible=!0,a?(Z.title="修改部门",P(a).then((({data:e})=>{Object.assign(le,e)}))):(Z.title="新增部门",le.parentId=e??0)}function de(){G.value.validate((e=>{if(e){const e=le.id;L.value=!0,e?S(e,le).then((()=>{b.success("修改成功"),ue(),se()})).finally((()=>L.value=!1)):W(le).then((()=>{b.success("新增成功"),ue(),se()})).finally((()=>L.value=!1))}}))}function ne(e){const a=[e||N.value].join(",");a?y.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{D(a).then((()=>{b.success("删除成功"),oe()}))})):b.warning("请勾选删除项")}function ue(){Z.visible=!1,G.value.resetFields(),G.value.clearValidate(),le.id=void 0,le.parentId=0,le.status=1,le.sort=1}return t((()=>{se()})),(e,a)=>{const l=_,t=T,b=I,y=E,K=B,P=j,S=w,W=R,D=O,H=C,pe=z,me=J,ce=x,fe=A,he=F,be=q,ye=U,_e=k,je=V,ve=g,ge=s("hasPerm"),ke=v;return o(),r("div",M,[i("div",Q,[d(W,{ref_key:"queryFormRef",ref:Y,model:u($),inline:!0},{default:n((()=>[d(t,{label:"关键字",prop:"keywords"},{default:n((()=>[d(l,{modelValue:u($).keywords,"onUpdate:modelValue":a[0]||(a[0]=e=>u($).keywords=e),placeholder:"部门名称",onKeyup:p(se,["enter"])},null,8,["modelValue"])])),_:1}),d(t,{label:"部门状态",prop:"status"},{default:n((()=>[d(y,{modelValue:u($).status,"onUpdate:modelValue":a[1]||(a[1]=e=>u($).status=e),placeholder:"部门状态",clearable:""},{default:n((()=>[d(b,{value:1,label:"正常"}),d(b,{value:0,label:"禁用"})])),_:1},8,["modelValue"])])),_:1}),d(t,null,{default:n((()=>[d(P,{class:"filter-item",type:"primary",onClick:se},{default:n((()=>[d(K),m(" 搜索 ")])),_:1}),d(P,{onClick:oe},{default:n((()=>[d(S),m("重置 ")])),_:1})])),_:1})])),_:1},8,["model"])]),d(he,{shadow:"never",class:"table-container"},{header:n((()=>[c((o(),f(P,{type:"success",onClick:a[2]||(a[2]=e=>ie(0,void 0))},{default:n((()=>[d(D),m("新增")])),_:1})),[[ge,["sys:dept:add"]]]),c((o(),f(P,{type:"danger",disabled:0===u(N).length,onClick:a[3]||(a[3]=e=>ne())},{default:n((()=>[d(H),m("删除 ")])),_:1},8,["disabled"])),[[ge,["sys:dept:delete"]]])])),default:n((()=>[c((o(),f(fe,{data:u(ee),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:re},{default:n((()=>[d(pe,{type:"selection",width:"55",align:"center"}),d(pe,{prop:"name",label:"部门名称","min-width":"200"}),d(pe,{prop:"status",label:"状态",width:"100"},{default:n((e=>[1==e.row.status?(o(),f(me,{key:0,type:"success"},{default:n((()=>[m("正常")])),_:1})):(o(),f(me,{key:1,type:"info"},{default:n((()=>[m("禁用")])),_:1}))])),_:1}),d(pe,{prop:"sort",label:"排序",width:"100"}),d(pe,{label:"操作",fixed:"right",align:"left",width:"200"},{default:n((e=>[c((o(),f(P,{type:"primary",link:"",size:"small",onClick:h((a=>ie(e.row.id,void 0)),["stop"])},{default:n((()=>[d(D),m("新增 ")])),_:2},1032,["onClick"])),[[ge,["sys:dept:add"]]]),c((o(),f(P,{type:"primary",link:"",size:"small",onClick:h((a=>ie(e.row.parentId,e.row.id)),["stop"])},{default:n((()=>[d(ce),m("编辑 ")])),_:2},1032,["onClick"])),[[ge,["sys:dept:edit"]]]),c((o(),f(P,{type:"primary",link:"",size:"small",onClick:h((a=>ne(e.row.id)),["stop"])},{default:n((()=>[d(H),m("删除 ")])),_:2},1032,["onClick"])),[[ge,["sys:dept:delete"]]])])),_:1})])),_:1},8,["data"])),[[ke,u(L)]])])),_:1}),d(ve,{modelValue:u(Z).visible,"onUpdate:modelValue":a[8]||(a[8]=e=>u(Z).visible=e),title:u(Z).title,width:"600px",onClosed:ue},{footer:n((()=>[i("div",X,[d(P,{type:"primary",onClick:de},{default:n((()=>[m(" 确 定 ")])),_:1}),d(P,{onClick:ue},{default:n((()=>[m(" 取 消 ")])),_:1})])])),default:n((()=>[d(W,{ref_key:"deptFormRef",ref:G,model:u(le),rules:u(te),"label-width":"80px"},{default:n((()=>[d(t,{label:"上级部门",prop:"parentId"},{default:n((()=>[d(be,{modelValue:u(le).parentId,"onUpdate:modelValue":a[4]||(a[4]=e=>u(le).parentId=e),placeholder:"选择上级部门",data:u(ae),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),d(t,{label:"部门名称",prop:"name"},{default:n((()=>[d(l,{modelValue:u(le).name,"onUpdate:modelValue":a[5]||(a[5]=e=>u(le).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),d(t,{label:"显示排序",prop:"sort"},{default:n((()=>[d(ye,{modelValue:u(le).sort,"onUpdate:modelValue":a[6]||(a[6]=e=>u(le).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])])),_:1}),d(t,{label:"部门状态"},{default:n((()=>[d(je,{modelValue:u(le).status,"onUpdate:modelValue":a[7]||(a[7]=e=>u(le).status=e)},{default:n((()=>[d(_e,{label:1},{default:n((()=>[m("正常")])),_:1}),d(_e,{label:0},{default:n((()=>[m("禁用")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{Y as default};
